<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MC - CA</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; transition: background-color 0.4s; }
        body, html { height: 100%; width: 100%; background-color: white; overflow: hidden; }

        #bg-canvas { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0; pointer-events: none; }

        /* --- INTRO --- */
        #intro-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 1000; display: flex; justify-content: center; align-items: center;
        }
        video { width: 100%; height: 100%; object-fit: cover; }
        #enter-btn {
            position: absolute; bottom: 5%; right: 5%;
            background: none; border: none; color: white;
            font-size: 1.2rem; cursor: pointer; display: none; font-weight: bold;
        }

        /* --- HOME --- */
        #home-page {
            display: none; height: 100vh; width: 100vw;
            justify-content: center; align-items: center; position: relative; z-index: 10;
        }
        .main-logo { font-size: 8rem; font-weight: bold; letter-spacing: 2px; position: relative; }
        .hidden-link { position: absolute; top: 0; width: 40%; height: 100%; background: transparent; cursor: pointer; border: none; }
        .link-mc { left: 0; } .link-ca { right: 0; }

        /* --- HEADER ORIGINALE --- */
        .header {
            padding: 20px 5%; 
            border-bottom: 2px solid white; 
            background-color: rgba(244, 244, 244, 0.95); 
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 30;
            min-height: 140px;
        }
        .header-titles h1 { font-size: 3.5rem; font-weight: bold; margin-bottom: 5px; }
        .header-titles p { font-size: 1.1rem; color: #333; }
        
        /* Contenitore Titolo e Software al centro */
        .header-center {
            position: absolute; left: 50%; transform: translateX(-50%);
            display: flex; flex-direction: column; align-items: center; gap: 8px;
            text-align: center;
        }
        .header-center-title { font-size: 1.5rem; font-weight: bold; color: black; text-transform: uppercase; }
        .software-list { display: flex; gap: 15px; font-size: 0.85rem; font-weight: bold; color: black; }
        .sw-item { padding: 2px 4px; }
        .sw-item.highlight { background-color: rgb(169, 212, 177); } /* Rettangolo verde software */

        .header-logo img { height: 60px; width: auto; object-fit: contain; }

        /* --- CONTENT --- */
        .content-wrapper { display: flex; flex: 1; overflow: hidden; flex-direction: row-reverse; background: transparent; }
        
        .gallery { 
            flex: 1; display: flex; flex-direction: column; align-items: center; 
            overflow-y: auto; padding: 5%; gap: 60px; z-index: 20;
        }
        
        .img-box { width: 100%; display: flex; flex-direction: column; }
        .gallery img { width: 100%; height: auto; object-fit: contain; display: block; }
        
        .caption {
            align-self: flex-end; margin-top: 10px; font-size: 0.9rem; color: black; font-weight: bold;
            text-transform: uppercase; background-color: white; padding: 2px 5px; /* Sfondo bianco non trasparente */
        }

        .project-description {
            width: 100%; background: rgba(255, 255, 255, 0.95); padding: 2.5%; 
            color: black; font-size: 1rem; line-height: 1.5; text-align: center; margin-bottom: 20px; display: none; 
        }

        /* SIDEBAR ORIGINALE */
        .sidebar {
            width: 300px; border-right: 2px solid grey; 
            display: flex; flex-direction: column; padding: 40px 0 40px 5%; gap: 15px;
            background: rgba(255, 255, 255, 0.95); z-index: 30;
        }
        .menu-item { cursor: pointer; font-size: 1.1rem; color: black; text-transform: uppercase; text-align: left; }
        .menu-item:hover { color: #888; text-decoration: underline; }
        
        /* Colori Active */
        .menu-item.active-blue { color: rgb(122, 161, 190) !important; font-weight: bold; }
        .menu-item.active-green { color: rgb(169, 212, 177) !important; font-weight: bold; }

        .back-home { margin-top: auto; font-size: 1.1rem; cursor: pointer; font-weight: bold; text-transform: none; color: black; }

        /* DARK MODE */
        .dark-mode { background-color: black !important; color: white !important; }
        .dark-mode .header { background-color: rgba(26, 26, 26, 1) !important; }
        .dark-mode .sidebar { border-right: 2px solid #444 !important; background: black !important; }
        .dark-mode .menu-item, .dark-mode .back-home, .dark-mode .header-titles p, .dark-mode .caption { color: white !important; }
        .dark-mode .header-center-title, .dark-mode .software-list { color: white !important; }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>

    <div id="intro-container">
        <video id="myVideo" autoplay muted playsinline loop>
            <source src="intro.mp4" type="video/mp4">
        </video>
        <button id="enter-btn" onclick="showHome()">ENTRA</button>
    </div>

    <div id="home-page">
        <div class="main-logo">
            MC - CA
            <button class="hidden-link link-mc" onclick="showPage('page-mc')"></button>
            <button class="hidden-link link-ca" onclick="showPage('page-ca')"></button>
        </div>
    </div>

    <div id="page-mc" class="sub-page">
        <div class="header">
            <div class="header-titles"><h1>MC</h1><p>Martina Colucci</p></div>
            <div class="header-center">
                <div class="header-center-title" id="center-title-mc"></div>
                <div class="software-list">
                    <span class="sw-item">AutoCAD</span><span class="sw-item">SketchUp</span><span class="sw-item">Illustrator</span>
                </div>
            </div>
            <div class="header-logo"><img src="logo.PNG" alt="Logo"></div>
        </div>
        <div class="content-wrapper">
            <div class="gallery" id="gallery-mc"></div>
            <div class="sidebar" id="menu-mc"></div>
        </div>
    </div>

    <div id="page-ca" class="sub-page">
        <div class="header">
            <div class="header-titles"><h1>CA</h1><p>Claudio Antonelli</p></div>
            <div class="header-center">
                <div class="header-center-title" id="center-title-ca"></div>
                <div class="software-list">
                    <span class="sw-item sw-ca-item">AutoCAD</span>
                    <span class="sw-item sw-ca-item">SketchUp</span>
                    <span class="sw-item sw-ca-item">Illustrator</span>
                </div>
            </div>
            <div class="header-logo"><img src="logo.PNG" alt="Logo"></div>
        </div>
        <div class="content-wrapper">
            <div class="gallery" id="gallery-ca">
                <div id="desc-casa-pioniera" class="project-description">
                    La Casa Pioniera è un progetto di un cohousing per genitori divorziati. Il lotto è situato a Nord di Torino, nel quartiere di Barriera di Milano, ma effettivamente l’idea progettuale si estende nel primo intorno della zona. L’edificio è di quattro piani fuori terra e si relaziona con il contesto densamente edificato e la forma triangolare del lotto è stato sfruttato per la sua opportunità di essere un edificio di testa. Quest’ultima caratteristica ha dato il nome del progetto infatti, la Casa Pioniera. Il piano terra ospita locali dedicati alla comunità, motivo per cui lo spazio contiguo è di fondamentale importanza per garantire continuità e qualità architettonica. I piani superiori invece ospitano le residenze. La copertura è uno spazio comune riservato.
                </div>
            </div>
            <div class="sidebar" id="menu-ca"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let currentEffect = "";
        let ellipses = []; let randomLines = [];
        let mouseX = 0, mouseY = 0;
        const cpCaptions = ["Assonometria", "Pianta piano tipo", "Prospetto Sud", "Sezione A-A"];

        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; if(currentEffect) drawEffect(currentEffect); }
        window.addEventListener('resize', resize); resize();
        window.addEventListener('mousemove', (e) => {
            mouseX = e.clientX; mouseY = e.clientY;
            if (currentEffect === "CASA PIONIERA" || currentEffect === "THE ELLIPSE") requestAnimationFrame(() => drawEffect(currentEffect));
        });

        setTimeout(() => { document.getElementById('enter-btn').style.display = 'block'; }, 3000);

        function showHome() {
            document.getElementById('intro-container').style.display = 'none';
            document.getElementById('home-page').style.display = 'flex';
        }

        function showPage(id) {
            document.getElementById('home-page').style.display = 'none';
            document.querySelectorAll('.sub-page').forEach(p => p.style.display = 'none');
            document.getElementById(id).style.display = 'flex';
            currentEffect = ""; clearCanvas(); document.body.classList.remove('dark-mode');
            document.querySelectorAll('.menu-item').forEach(m => { m.classList.remove('active-blue'); m.classList.remove('active-green'); });
            document.querySelectorAll('.sw-ca-item').forEach(s => s.classList.remove('highlight'));
        }

        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

        function drawEffect(type) {
            currentEffect = type; clearCanvas(); document.body.classList.remove('dark-mode');
            ctx.strokeStyle = "black"; ctx.lineWidth = 1.5;
            if (type === "CASA PIONIERA") {
                const w = 60, h = 90;
                for(let x=0; x<canvas.width; x+=w) {
                    for(let y=0; y<canvas.height; y+=h) {
                        ctx.beginPath(); ctx.rect(x, y, w, h);
                        if (mouseX >= x && mouseX <= x + w && mouseY >= y && mouseY <= y + h) { 
                            ctx.fillStyle = "rgba(169, 212, 177, 0.5)"; ctx.fill(); 
                        }
                        ctx.stroke();
                    }
                }
            } else if (type === "CENTRO POLIFUNZIONALE") {
                if (randomLines.length === 0) { for(let i=0; i<40; i++) randomLines.push({ x1: Math.random() * canvas.width, y1: 0, x2: Math.random() * canvas.width, y2: canvas.height }); }
                randomLines.forEach(l => { ctx.beginPath(); ctx.moveTo(l.x1, l.y1); ctx.lineTo(l.x2, l.y2); ctx.stroke(); });
            } else if (type === "THE ELLIPSE") {
                if (ellipses.length === 0) { for(let i=0; i<30; i++) ellipses.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, rx: 100, ry: 50, rot: Math.random()*Math.PI }); }
                ellipses.forEach(e => {
                    ctx.beginPath(); ctx.ellipse(e.x, e.y, e.rx, e.ry, e.rot, 0, Math.PI*2);
                    let dx = mouseX - e.x, dy = mouseY - e.y, cos = Math.cos(-e.rot), sin = Math.sin(-e.rot), xh = cos * dx - sin * dy, yh = sin * dx + cos * dy;
                    if ((xh*xh)/(e.rx*e.rx) + (yh*yh)/(e.ry*e.ry) <= 1) { ctx.fillStyle = "rgba(122, 161, 190, 0.5)"; ctx.fill(); }
                    ctx.stroke();
                });
            } else if (type === "RELOADINGENOVA") { document.body.classList.add('dark-mode'); }
        }

        const data = { 'mc': ["PROGETTO 1", "PROGETTO 2", "PROGETTO 3"], 'ca': ["CASA PIONIERA", "CENTRO POLIFUNZIONALE", "THE ELLIPSE", "RELOADINGENOVA"] };

        function setupMenu(prefix) {
            const menu = document.getElementById(`menu-${prefix}`);
            const gallery = document.getElementById(`gallery-${prefix}`);
            const centerTitle = document.getElementById(`center-title-${prefix}`);

            data[prefix].forEach(item => {
                const div = document.createElement('div');
                div.className = 'menu-item'; div.innerText = item;
                div.onclick = () => {
                    document.querySelectorAll('.menu-item').forEach(m => { m.classList.remove('active-blue'); m.classList.remove('active-green'); });
                    document.querySelectorAll('.sw-ca-item').forEach(s => s.classList.remove('highlight'));
                    
                    if(item === "CASA PIONIERA") {
                        div.classList.add('active-green');
                        document.querySelectorAll('.sw-ca-item').forEach(s => s.classList.add('highlight'));
                    } else { div.classList.add('active-blue'); }

                    centerTitle.innerText = item;
                    const descBox = document.getElementById('desc-casa-pioniera');
                    gallery.querySelectorAll('.img-box').forEach(b => b.remove());
                    
                    if (item === "CASA PIONIERA") {
                        if(descBox) descBox.style.display = "block";
                        for(let i=1; i<=4; i++) {
                            const box = document.createElement('div'); box.className = 'img-box';
                            const img = document.createElement('img');
                            let ext = (i < 4) ? ".png" : ".PNG";
                            img.src = `CA/CASA PIONIERA ${i}${ext}`;
                            img.onerror = function() { this.src = this.src.includes(".PNG") ? this.src.replace(".PNG", ".png") : this.src.replace(".png", ".PNG"); };
                            const cap = document.createElement('div'); cap.className = 'caption'; cap.innerText = cpCaptions[i-1];
                            box.appendChild(img); box.appendChild(cap); gallery.appendChild(box);
                        }
                    } else {
                        if(descBox) descBox.style.display = "none";
                        const box = document.createElement('div'); box.className = 'img-box';
                        const img = document.createElement('img'); img.src = `${prefix.toUpperCase()}/${item}.PNG`;
                        img.onerror = function() { this.src = this.src.replace(".PNG", ".png"); };
                        box.appendChild(img); gallery.appendChild(box);
                    }
                    if(prefix === 'ca') { if(item !== "THE ELLIPSE") ellipses = []; if(item !== "CENTRO POLIFUNZIONALE") randomLines = []; drawEffect(item); }
                    else { currentEffect = ""; clearCanvas(); }
                };
                menu.appendChild(div);
            });

            const back = document.createElement('div');
            back.className = 'back-home'; back.innerText = "MC - CA";
            back.onclick = () => {
                document.body.classList.remove('dark-mode'); clearCanvas();
                gallery.querySelectorAll('.img-box').forEach(b => b.remove());
                if(document.getElementById('desc-casa-pioniera')) document.getElementById('desc-casa-pioniera').style.display = "none";
                document.querySelectorAll('.sub-page').forEach(p => p.style.display = 'none');
                document.getElementById('home-page').style.display = 'flex';
            };
            menu.appendChild(back);
        }

        setupMenu('mc'); setupMenu('ca');
    </script>
</body>
</html>
